<!-- Modal de Registro Exitoso -->
@if (config.saveDataFactura()) {
  <div class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50">
    <div class="bg-white rounded-2xl p-6 w-full max-w-md shadow-xl relative">
      <button
        class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 focus:outline-none"
        (click)="config.saveDataFactura.set(false)"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <div class="text-center">
        <img src="assets/success.png" alt="Alert Icon" class="w-16 h-16 mx-auto mb-4" />
        <h3 class="text-xl font-semibold text-gray-800">¡Datos Registro Exitosos!</h3>
        <p class="text-sm text-gray-600 mt-2">
          {{ config.modalMessage }}
        </p>
      </div>

      @if (!config.loading()) {
        <div class="mt-6 grid gap-3 sm:flex sm:justify-center">
          <!-- <button
            class="px-5 py-2 border border-gray-100 bg-gray-100 rounded-lg hover:bg-gray-200 w-full sm:w-auto"
            (click)="config.saveDocument(config.infoProforma() ? 'guardar' : 'proforma')"
          >
            {{ config.infoProforma() ? 'Guardar' : 'Proforma' }}
          </button> -->

          <button
            class="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 w-full sm:w-auto"
            (click)="config.saveDocument()"
          >
            Confirmar
          </button>
        </div>
      } @else {
        <div class="flex justify-center items-center h-full mt-4">
          <div class="loader"></div>
        </div>
      }
    </div>
  </div>
}

@if (!config.loading()) {
  <div class="flex flex-col md:flex-row justify-end gap-4 p-2 text-center">
    <button
      class="flex items-center justify-center px-4 py-2 text-sm font-semibold rounded-lg border bg-gray-200 text-gray-700 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition duration-300 w-full md:w-auto"
      type="button"
      (click)="config.saveDatos('Guardar')"
    >
      <svg
        class="w-6 h-6 text-gray-800 dark:text-black mr-2"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          fill-rule="evenodd"
          d="M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7.414A2 2 0 0 0 20.414 6L18 3.586A2 2 0 0 0 16.586 3H5Zm3 11a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v6H8v-6Zm1-7V5h6v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1Z"
          clip-rule="evenodd"
        />
        <path fill-rule="evenodd" d="M14 17h-4v-2h4v2Z" clip-rule="evenodd" />
      </svg>
      Guardar
    </button>
    <button
      class="flex items-center justify-center px-4 py-2 text-sm font-semibold rounded-lg border  focus:outline-none focus:ring-2 focus:ring-blue-300 transition duration-300 w-full md:w-auto"
      type="button"
      (click)="config.saveDatos('Credito')"
      [ngClass]="{
        'bg-gray-300 text-gray-500 cursor-not-allowed': !hasPaymentCode('00'),
        'bg-gray-200 text-gray-700 hover:bg-gray-300': hasPaymentCode('00')
      }"
    >
      <svg
        class="w-6 h-6 text-gray-800 dark:text-black mr-2"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          fill-rule="evenodd"
          d="M14 7h-4v3a1 1 0 0 1-2 0V7H6a1 1 0 0 0-.997.923l-.917 11.924A2 2 0 0 0 6.08 22h11.84a2 2 0 0 0 1.994-2.153l-.917-11.924A1 1 0 0 0 18 7h-2v3a1 1 0 1 1-2 0V7Zm-2-3a2 2 0 0 0-2 2v1H8V6a4 4 0 0 1 8 0v1h-2V6a2 2 0 0 0-2-2Z"
          clip-rule="evenodd"
        />
      </svg>
      Crédito
    </button>



    <button
      class="flex items-center justify-center px-4 py-2 text-sm font-semibold rounded-lg border bg-green-500 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-blue-300 transition duration-300 w-full md:w-auto"
      type="button"
      (click)="config.saveDatos('Factura')"
    >
      <svg
        class="w-6 h-6 text-gray-800 dark:text-white mr-2"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          fill-rule="evenodd"
          d="M9 7V2.221a2 2 0 0 0-.5.365L4.586 6.5a2 2 0 0 0-.365.5H9Zm2 0V2h7a2 2 0 0 1 2 2v6.41A7.5 7.5 0 1 0 10.5 22H6a2 2 0 0 1-2-2V9h5a2 2 0 0 0 2-2Z"
          clip-rule="evenodd"
        />
        <path
          fill-rule="evenodd"
          d="M9 16a6 6 0 1 1 12 0 6 6 0 0 1-12 0Zm6-3a1 1 0 0 1 1 1v1h1a1 1 0 1 1 0 2h-1v1a1 1 0 1 1-2 0v-1h-1a1 1 0 1 1 0-2h1v-1a1 1 0 0 1 1-1Z"
          clip-rule="evenodd"
        />
      </svg>
      Enviar SRI
    </button>
  </div>

  <div class="flex flex-wrap mb-4">
    @defer {
      <section class="p-2 flex-[2]">
        <app-info-empresa (idePersonaRol)="$event && setPersonaRol($event)" [infoProforma]="config.infoProforma()" />
      </section>
    }
    @defer {
      <section class="p-2 flex-[1]">
        <app-info-cliente-empresa [setPersonaRol]="ide()" [proformaCliente]="config.infoProforma()?.infoCustomer" />
      </section>
    }
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-4 gap-4 m-2">
    <section class="lg:col-span-3 space-y-4">
      @defer {
        <app-info-productos [setPersonaRol]="ide()" [editProformaProducto]="config.infoProforma()?.detailProducts" />
      }
    </section>
    @defer {
      <section class="lg:col-span-1 space-y-4">
        <app-resumen-pago-enpresa [valid]="valid" [editarResumenPago]="config.infoProforma()" />
      </section>
    }
  </div>
}
